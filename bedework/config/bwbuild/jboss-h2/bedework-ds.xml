<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE datasources
        PUBLIC "-//JBoss//DTD JBOSS JCA Config 1.5//EN"
        "http://www.jboss.org/j2ee/dtd/jboss-ds_1_5.dtd">

<datasources>
  <local-tx-datasource>
    <jndi-name>CalendarDS</jndi-name>

    <!-- Server mode needs the mbean -->
    <driver-class>org.h2.Driver</driver-class>

    <connection-url>jdbc:h2:tcp://localhost:9092/${jboss.server.data.dir}/bedework/h2/CalDb3p6;MVCC=TRUE</connection-url>

    <depends>org.bedework:service=H2Db</depends>

    <user-name>sa</user-name>
    <password>bw</password>
    <min-pool-size>5</min-pool-size>
    <max-pool-size>20</max-pool-size>
    <idle-timeout-minutes>5</idle-timeout-minutes>
    <track-statements/>

    <!-- corresponding type-mapping in the standardjbosscmp-jdbc.xml (optional) -->
    
    <!-- Note there is no H2 mapping (yet). H2 is apparently compatible with postgres -->
    <metadata>
      <type-mapping>PostgreSQL</type-mapping>
    </metadata>
  </local-tx-datasource>

  <!-- mbean for server mode -->
  <mbean code="edu.rpi.cmt.db.hibernate.h2.H2Db" 
         name="org.bedework:service=H2Db">
    <!-- Should be done like this
    <attribute name="Port">        
      <value-factory bean="ServiceBindingManager" method="getIntBinding" 
           parameter="jboss:service=H2"/>
    </attribute>
    -->
    <attribute name="Port">9092</attribute>
    <!--
    <attribute name="BindAddress">        
        <value-factory bean="ServiceBindingManager" method="getStringBinding" 
           parameter="jboss:service=Hypersonic"/>
    </attribute>     
    -->
    <attribute name="Account">sa</attribute>
    <attribute name="Pw">bw</attribute>
  </mbean>
</datasources>

