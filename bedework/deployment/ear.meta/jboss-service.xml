<?xml version="1.0" encoding="UTF-8"?>
<server>
  <!--  guarantee separate classloader -->
  <loader-repository> 
    org.bedework:archive=bedework-services 
  </loader-repository> 
  
  <mbean code="org.bedework.indexer.BwIndexer"
         name="org.bedework:service=Indexer">
    <attribute name="Account">admin</attribute>
    <attribute name="SkipPaths">/public/unbrowsable:/public/aliases:*/Outbox:*/Inbox:*/Deleted</attribute>
    
    <attribute name="MaxPublicThreads">5</attribute>
    <attribute name="MaxUserThreads">5</attribute>

    <!-- We need activemq -->    
    <depends>jboss.jca:service=ConnectionFactoryBinding,name=activemq/QueueConnectionFactory</depends>
    
    <!-- We also need the bedework database -->
    <depends>jboss.jca:service=DataSourceBinding,name=CalendarDS</depends>
  </mbean>
  
  <!-- 
  <mbean code="org.bedework.calsvc.scheduling.ischedule.BwIschedule"
         name="org.bedework:service=Ischedule">
    <attribute name="Account">admin</attribute>
    
    < ! - - We also need the bedework database - - >
    <depends>jboss.jca:service=DataSourceBinding,name=CalendarDS</depends>
  </mbean>
   -->
  
  <mbean code="org.bedework.chgnote.BwChgNote"
         name="org.bedework:service=BwChgNote">
         <!--  no attributes yet
    <attribute name="Account">admin</attribute>
    <attribute name="SkipPaths">/public/unbrowsable:/public/aliases</attribute>
    -->

    <!-- We need activemq -->    
    <depends>jboss.jca:service=ConnectionFactoryBinding,name=activemq/QueueConnectionFactory</depends>
    
    <!-- We also need the bedework database -->
    <depends>jboss.jca:service=DataSourceBinding,name=CalendarDS</depends>
  </mbean>
  
  <mbean code="org.bedework.inoutsched.BwInoutSched"
         name="org.bedework:service=BwInoutSched">
         <!--  no attributes yet
    <attribute name="Account">admin</attribute>
    <attribute name="SkipPaths">/public/unbrowsable:/public/aliases</attribute>
    -->

    <!-- We need activemq -->    
    <depends>jboss.jca:service=ConnectionFactoryBinding,name=activemq/QueueConnectionFactory</depends>
    
    <!-- We also need the bedework database -->
    <depends>jboss.jca:service=DataSourceBinding,name=CalendarDS</depends>
  </mbean>
  
  <mbean code="org.bedework.caldav.server.soap.synch.SynchConnections"
         name="org.bedework:service=CalDAVSynchConnections">
  </mbean>
  
  <mbean code="org.bedework.dumprestore.BwDumpRestore"
         name="org.bedework:service=DumpRestore">
    <attribute name="Account">admin</attribute>
    
    <attribute name="Appname"/>
    
    <!-- Statement delimiter -->
    <attribute name="Delimiter">;</attribute>
    
    <!-- Export to database? - false for safety - set true in console -->
    <attribute name="Export">false</attribute>
    
    <!-- Schema Output file name - full path, folders must exist -->
    <attribute name="SchemaOutFile">${jboss.server.data.dir}/bedework/dumprestore/schema.txt</attribute>
    
    <!-- XML data input file name - full path. Used for data restore -->
    <attribute name="DataIn">${jboss.server.data.dir}/bedework/dumprestore/initbedework.xml</attribute>
    
    <!-- XML data output directory - full path. Used for data dump -->
    <attribute name="DataOut">${jboss.server.data.dir}/bedework/dumprestore/</attribute>
    
    <!-- XML data output file prefix - for data dump -->
    <attribute name="DataOutPrefix">bwdata</attribute>

    <!-- We need activemq -->    
    <depends>jboss.jca:service=ConnectionFactoryBinding,name=activemq/QueueConnectionFactory</depends>
    
    <!-- We also need the bedework database -->
    <depends>jboss.jca:service=DataSourceBinding,name=CalendarDS</depends>
  </mbean>
  
  <mbean code="edu.rpi.sss.util.servlets.io.PooledBufferedOutputStream"
         name="org.bedework:service=PooledBuffers">
    <!-- buffer size -->
    <attribute name="SmallBufferSize"/>
    
    <!-- buffer size -->
    <attribute name="MediumBufferSize"/>
    
    <!-- buffer size -->
    <attribute name="LargeBufferSize"/>
    
    <!-- buffer pool size -->
    <attribute name="SmallBufferPoolSize"/>
    
    <!-- buffer pool size -->
    <attribute name="MediumBufferPoolSize"/>
    
    <!-- buffer pool size -->
    <attribute name="LargeBufferPoolSize"/>
    
    <!-- buffer pool size -->
    <attribute name="SmallBufferPoolStats"/>
    
    <!-- buffer pool size -->
    <attribute name="MediumBufferPoolStats"/>
    
    <!-- buffer pool size -->
    <attribute name="LargeBufferPoolStats"/>    
  </mbean>
  
  <mbean code="edu.rpi.sss.util.http.service.HttpOut"
         name="org.bedework:service=BwHttpOut">
  </mbean>
</server>
